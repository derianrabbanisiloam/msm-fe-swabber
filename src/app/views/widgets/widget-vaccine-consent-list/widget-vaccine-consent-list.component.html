<div class="fo_vaccine_container">
  <div class="row">
    <div class="col-3 d-print-none">
      <div class="search-form shadow-sm">
        <ngb-tabset type="pills">
          <ngb-tab title="By Code">
            <ng-template ngbTabContent>
              <form (ngSubmit)="searchByCode()" class="mt-2">
                <label for="unique-code">Patient unique code</label>
                <input id="unique-code" name="unique-code" class="form-control" placeholder="Enter patient unique code"
                  [(ngModel)]="uniqueCode" autocomplete="off" />
                <input type="submit" value="Search" class="btn-primary mt-2" />
              </form>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="By Name">
            <ng-template ngbTabContent>
              <form (ngSubmit)="searchByNameDob()" class="mt-2">
                <label for="patient-name">Patient name</label>
                <input id="patient-name" name="patient-name" class="form-control" placeholder="Enter patient name"
                  [(ngModel)]="patientName" autocomplete="off" />
                <label for="dob">Date of birth</label>
                <input id="dob" name="dob" class="form-control" placeholder="dd-mm-yyyy" [(ngModel)]="dob"
                  autocomplete="off" [textMask]="{ mask: maskBirth }" />
                <input type="submit" value="Search" class="btn-primary mt-2" />
              </form>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
      </div>
      <div class="consent-result mt-4">
        <div *ngIf="consents.length > 0">
          <div *ngFor="let consent of consents">
            <div class="card shadow-sm" (click)="goToDetail(consent)">
              <div class="card-body">
                <h5 class="card-title">{{ consent.patient_name }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">
                  {{ consent.date_of_birth | date }}
                </h6>
                <h6 class="card-subtitle mb-2 text-muted">
                  {{ consent.mobile_no }}
                </h6>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="showWaitMsg" class="alert alert-warning" role="alert">
          Please wait ...
        </div>
        <div *ngIf="showNotFoundMsg" class="alert alert-danger" role="alert">
          No data found
        </div>
      </div>
    </div>
    <div class="col-9" *ngIf="showDetailConsent && consentInfo.detail.length > 0">
      <div class="consent-detail">
        <form class="" (ngSubmit)="updateConsent()">
          <div class="row">
            <div class="col-6">
              <label for="patient-name">Name</label>
              <input id="patient-name" name="patient-name" class="form-control" [(ngModel)]="consentInfo.patient_name"
                autocomplete="off" />
            </div>
            <div class="col-6">
              <label for="patient-dob">Date of birth</label>
              <input id="patient-dob" name="patient-dob" class="form-control" [ngModel]="consentInfo.date_of_birth | date:'dd-MM-yyyy'" (ngModelChange)="consentInfo.date_of_birth=$event"
                autocomplete="off" />
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              <label for="patient-mobile">Phone</label>
              <input id="patient-mobile" name="patient-mobile" class="form-control" [(ngModel)]="consentInfo.mobile_no"
                autocomplete="off" />
            </div>
            <div class="col-6">
              <label for="patient-email">Email</label>
              <input id="patient-email" name="patient-email" class="form-control"
                [(ngModel)]="consentInfo.email_address" autocomplete="off" />
            </div>
          </div>
          <div *ngFor="let q of consentInfo.detail" class="mt-2">
            <div class="mb-4">
              <label for="question">{{q.consent_question_name}}</label>
              <div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="checkbox-yes" value="Ya"
                    name="checkbox-answer-yes" [checked]="q.answer_value === 'Ya' || q.answer_value === 'yes'"
                    (change)="fieldsChange($event, q.consent_detail_id)">
                  <label class="form-check-label" for="checkbox-yes">Ya</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox" id="checkbox-no" value="Tidak"
                    name="checkbox-answer-no" [checked]="q.answer_value === 'Tidak' || q.answer_value === 'no'"
                    (change)="fieldsChange($event, q.consent_detail_id)">
                  <label class="form-check-label" for="checkbox-no">Tidak</label>
                </div>
              </div>
            </div>
          </div>
          <div style="display: flex; align-items: baseline;">
            <input type="submit" value="Save" class="btn-primary mt-2" />
            <p [ngClass]="getAlertClass()">{{updateStatus}}</p>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>